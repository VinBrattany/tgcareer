<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>薪资管理</title>
    <script th:src="@{/static/jquery-3.3.1/jquery-3.3.1.min.js}" type="text/javascript"></script>
    <link th:href="@{/static/bootstrap-3.3.7-dist/css/bootstrap.min.css}" rel="stylesheet">
    <script th:src="@{/static/bootstrap-3.3.7-dist/js/bootstrap.min.js}" type="text/javascript"></script>
</head>
<body>
<form enctype="multipart/form-data" id="excelUpload"  th:action="@{/upload}" method="post" class="form-horizontal">
    <button id="uploadEventBtn" type="button" >选择文件</button>
    <input type="file" name="file" id="uploadEventFile">
    <input id="uploadEventPath"  disabled="disabled"  type="text" placeholder="请选择excel表"  >
</form>
<button type="button"  onclick="project.uploadBtn()" >上传</button>
</body>
<script type="text/javascript">
    var project;
    $(function(){
        project = new Project();
        project.init();
    });

    var Project = function(){

        this.init = function(){

            //模拟上传excel
            $("#uploadEventBtn").unbind("click").bind("click",function(){
                $("#uploadEventFile").click();
            });
            $("#uploadEventFile").bind("change",function(){
                $("#uploadEventPath").attr("value",$("#uploadEventFile").val());
            });
        };
        //点击上传按钮
        this.uploadBtn = function(){
            var uploadEventFile = $("#uploadEventFile").val();
            if(uploadEventFile === ''){
                alert("请选择excel,再上传");
            }else if(uploadEventFile.lastIndexOf(".xls")<0){//可判断以.xls和.xlsx结尾的excel
                alert("只能上传Excel文件");
            }else{
                var url = '/tgcareer/upload';
                var formData = new FormData($('form')[0]);
                project.sendAjaxRequest(url,formData);
            }
        };
        this.sendAjaxRequest = function(url,data){
            $.ajax({
                url : url,
                type:"post",
                data : data,
                success : function(result) {
                    if (result.code==='0'){
                        alert("excel上传成功!");
                    }else {
                        alert( result.msg);
                    }
                },
                error : function() {
                    alert( "excel上传失败");
                },
                cache : false,
                contentType : false,
                processData : false
            });
        };
    }
</script>
</html>