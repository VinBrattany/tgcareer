<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>薪资管理</title>
    <script th:src="@{/static/jquery-3.3.1/jquery-3.3.1.min.js}" type="text/javascript"></script>
    <link th:href="@{/static/bootstrap-3.3.7-dist/css/bootstrap.min.css}" rel="stylesheet">
    <script th:src="@{/static/bootstrap-3.3.7-dist/js/bootstrap.min.js}" type="text/javascript"></script>
</head>
<body>
<div class="panel panel-default">

<!-- Default panel contents -->
<div class="panel-heading text-center">小程序薪资信息</div>

<!-- Table -->
<table class="table table-bordered table-striped text-center ">
    <tr>
        <th class="text-center">城市</th>
        <th class="text-center">职位</th>
        <th class="text-center">公司</th>
        <th class="text-center">联系方式</th>
        <th class="text-center">数据操作</th>
    </tr>
    <!--/*@thymesVar id="salaries" type="java.util.List"*/-->
    <!--/*@thymesVar id="salary" type="com.main.tgcareer.modules.salary.entity.Salary"*/-->
    <tr th:id="${salary.id}" th:each="salary: ${salaries}">
        <td th:text="${salary.city}">北京</td>
        <td th:text="${salary.job}">精算师</td>
        <td th:text="${salary.corporation}">阿里巴巴</td>
        <td th:text="${salary.contact}">12345678</td>
        <td><button type="button" class="btn btn-info" th:onclick="'javascript:changeSalary(\''+${salary.id}+'\')'">修改</button><button type="button" class="btn btn-danger" th:onclick="'javascript:deleteSalary(\''+${salary.id}+'\')'">删除</button></td>
    </tr>
</table>
</div>
<div>
<form enctype="multipart/form-data" id="excelUpload"  th:action="@{/upload}" method="post" class="form-horizontal">
    <button id="uploadEventBtn" type="button" >选择文件</button>
    <input type="file" name="file" id="uploadEventFile">
    <input id="uploadEventPath"  disabled="disabled"  type="text" placeholder="请选择excel表"  >
</form>
<button type="button"  onclick="project.uploadBtn()" >上传</button>
</div>
</body>
<script type="text/javascript">
    var project;
    $(function(){
        project = new Project();
        project.init();
    });

    var Project = function(){

        this.init = function(){

            //模拟上传excel
            $("#uploadEventBtn").unbind("click").bind("click",function(){
                $("#uploadEventFile").click();
            });
            $("#uploadEventFile").bind("change",function(){
                $("#uploadEventPath").attr("value",$("#uploadEventFile").val());
            });
        };
        //点击上传按钮
        this.uploadBtn = function(){
            var uploadEventFile = $("#uploadEventFile").val();
            if(uploadEventFile === ''){
                alert("请选择excel,再上传");
            }else if(uploadEventFile.lastIndexOf(".xls")<0 || !(uploadEventFile.lastIndexOf(".xlsx")<0)){//可判断以.xls结尾的excel
                alert("只能上传Excel.xls文件");
            }else{
                var url = '/tgcareer/upload';
                var formData = new FormData($('form')[0]);
                project.sendAjaxRequest(url,formData);
            }
        };
        this.sendAjaxRequest = function(url,data){
            $.ajax({
                url : url,
                type:"post",
                data : data,
                success : function(result) {
                    if (result.code==='0'){
                        alert("excel上传成功!");
                        location.reload(true);
                    }else {
                        alert( result.msg);
                    }
                },
                error : function() {
                    alert( "excel上传失败");
                },
                cache : false,
                contentType : false,
                processData : false
            });
        };
    };
    function deleteSalary(id) {
        console.log(id);
    }
    function changeSalary(id) {
        console.log(id);
    }
</script>
<style>
    .table tbody tr td{
        vertical-align: middle;
    }
</style>
</html>